!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.TinyDatePicker=t()}(this,function(){"use strict";function e(e,t){var n=void 0;return function(){clearTimeout(n),n=setTimeout(t,e)}}function t(e,t){var a=e(t);if(a&&(t.el.firstChild.innerHTML=a),t.isBelow&&n(t),t.isModal||!t.inputFocused()){var r=t.el.querySelector(".dp-current");r&&r.focus()}}function n(e){var t=e.input.getBoundingClientRect(),n=document.documentElement;r(e,t,n),a(e,t,n),e.el.style.visibility=""}function a(e,t,n){var a=e.el,r=e.input,o=n.clientWidth,i=a.offsetWidth,c=t.left+i,u=c<o||t.right<i,s=r.offsetLeft-(u?0:c-o);a.style.left=s+"px"}function r(e,t,n){var a=e.el,r=e.input,o=n.clientHeight,i=a.offsetHeight;if(null===e.isAbove){var c=t.bottom+8+i;e.isAbove=c>o&&t.top>i}var u=r.offsetTop+(e.isAbove?-i-8:r.offsetHeight+8);a.style.top=u+"px"}function o(){var e=new Date;return e.setHours(0,0,0,0),e}function i(e,t){return e.toDateString()===t.toDateString()}function c(e,t){e=new Date(e);var n=e.getDate();return e.setDate(1),e.setMonth(t),e.setDate(n),e.getDate()<n&&e.setDate(1-e.getDate()),e}function u(e,t,n){return t?e(t):new Date(o().setFullYear(o().getFullYear()+n))}function s(e){var t=e.days,n=e.weekStartsMonday?1:0,a=e.currentDate,r=e.selectedDate,c=a.getMonth(),u=o().getTime();return'<div class="dp-cal"><header class="dp-cal-header"><a tabindex="-1" href="javascript:;" class="dp-prev">Prev</a><a tabindex="-1" href="javascript:;" class="dp-cal-month">'+e.months[c]+'</a><a tabindex="-1" href="javascript:;" class="dp-cal-year">'+a.getFullYear()+'</a><a tabindex="-1" href="javascript:;" class="dp-next">Next</a></header><div class="dp-days">'+t.map(function(e,a){return'<span class="dp-col-header">'+t[(a+n)%t.length]+"</span>"}).join("")+d(a,n,function(t){var n=t.getMonth()!==c,o=!e.inRange(t),s=t.getTime()===u,d="dp-day";return d+=n?" dp-edge-day":"",d+=i(t,a)?" dp-current":"",d+=i(t,r)?" dp-selected":"",d+=o?" dp-day-disabled":"",d+=s?" dp-day-today":"",'<a tabindex="-1" href="javascript:;" class="'+(d+=" "+e.dateClass(t,e))+'" data-date="'+t.getTime()+'">'+t.getDate()+"</a>"})+'</div><footer class="dp-cal-footer"><a tabindex="-1" href="javascript:;" class="dp-today">'+e.today+'</a><a tabindex="-1" href="javascript:;" class="dp-clear">'+e.clear+'</a><a tabindex="-1" href="javascript:;" class="dp-close">'+e.txtClose+"</a></footer></div>"}function d(e,t,n){var a="",r=new Date(e);r.setDate(1),r.setDate(1-r.getDay()+t),t&&2===r.getDate()&&r.setDate(-5);for(var o=0;o<42;++o)a+=n(r),r.setDate(r.getDate()+1);return a}function l(e){var t=e.months,n=e.currentDate,a=n.getMonth();return'<div class="dp-months">'+t.map(function(e,t){var n="dp-month";return'<a tabindex="-1" href="javascript:;" class="'+(n+=a===t?" dp-current":"")+'" data-month="'+t+'">'+e+"</a>"}).join("")+"</div>"}function p(e){var t=e.currentDate.getFullYear(),n=e.selectedDate.getFullYear();return'<div class="dp-years">'+f(e,function(e){var a="dp-year";return a+=e===t?" dp-current":"",'<a tabindex="-1" href="javascript:;" class="'+(a+=e===n?" dp-selected":"")+'" data-year="'+e+'">'+e+"</a>"})+"</div>"}function f(e,t){for(var n="",a=e.max.getFullYear(),r=a;r>=e.min.getFullYear();--r)n+=t(r);return n}function v(t,n){function a(e){var t=o.parse(e.target.value);isNaN(t)||o.onChange(t,!0)}var r=[],o=m(t,r,n||{});o.isModal?t.readOnly=!0:o.isPermanent||r.push(w("blur",t,e(5,function(){o.el&&!o.el.contains(document.activeElement)&&S(o)})));var i=e(5,function(){C(o)?S(o):g(o)});return o.isPermanent||(r.push(w("mousedown",t,function(){o.inputFocused()&&i()})),r.push(w("focus",t,i)),r.push(w("input",t,a))),o}function m(n,a,r){n=k(n);var i={input:"dp-permanent"!==r.mode?n:null,container:"dp-permanent"===r.mode?n:null,mode:r.mode||"dp-modal",days:r.days||["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:r.months||["January","February","March","April","May","June","July","August","September","October","November","December"],today:r.today||"Today",clear:r.clear||"Clear",txtClose:r.close||"Close",onOpen:r.onOpen||function(){},dateClass:r.dateClass||function(){},inRange:function(e){return(!r.inRange||r.inRange(e))&&i.min<=e&&i.max>=e},onSelectYear:r.onSelectYear||function(){},onSelectMonth:r.onSelectMonth||function(){},onChangeDate:r.onChangeDate||function(){},onNavigate:r.onNavigate||function(){},format:r.format||function(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()},parse:r.parse||function(e){var t=new Date(e);return isNaN(t)?o():t},inputFocused:function(){return!i.container&&n===document.activeElement},onChange:function(e,a){e&&!i.inRange(e)||(e&&(i.selectedDate=new Date(i.currentDate=e),i.onChangeDate(i)),a||i.isPermanent||(n.value=e?i.format(e):""),i.isModal?x(n):t(s,i),i.isPermanent||n.dispatchEvent(new T("change",{bubbles:!0})))},open:function(){C(i)||g(i)},close:function(){i.el&&(x(n),i.isBelow&&e(10,function(){S(i)})())},openYears:function(){i.open(),t(p,i)},openMonths:function(){i.open(),t(l,i)},setValue:function(e){e=i.parse(e),i.onChange(e)},addMonths:function(e){return i.currentDate=c(i.currentDate,i.currentDate.getMonth()+e),i.goToDate(i.currentDate)},addYears:function(e){return i.addMonths(12*e)},goToDate:function(e){return i.currentDate=i.parse(e),t(s,i),i.onNavigate(i),i.selectedDate},weekStartsMonday:r.weekStartsMonday,destroy:function(){i.close(),console.log("DESTROYING... ",a.length),a.forEach(function(e){e()})}};return i.min=u(i.parse,r.min,-100),i.max=u(i.parse,r.max,100),i.isModal="dp-modal"===i.mode,i.isBelow="dp-below"===i.mode,i.isPermanent="dp-permanent"===i.mode,i.preselectedDate=i.parse(r.preselectedDate)||new Date,i.isPermanent&&g(i),i}function g(n){if(!n.el){var a=n.input,r=document.createElement("div");if(r.className=n.mode,r.innerHTML='<div class="dp"></div>'+(n.isModal?'<a href="#" class="dp-focuser">.</a>':""),n.el=r,!n.isPermanent){var i=r.querySelector(".dp");w("blur",i,e(10,function(){i.contains(document.activeElement)||n.close()}))}switch(h(n),n.mode){case"dp-modal":document.body.appendChild(r);break;case"dp-below":r.style.visibility="hidden",a.parentElement.appendChild(r);break;case"dp-permanent":n.container.appendChild(r)}n.isAbove=null,t(s,n),w("mousedown",r,function(e){e.target!==r&&"A"!==e.target.tagName&&e.preventDefault()}),w("keydown",r,function(e){e.keyCode>=N&&e.keyCode<=F&&e.preventDefault(),r.querySelector(".dp-cal")?D(e,r,n):r.querySelector(".dp-months")?monthsKeydown(e,r,n):r.querySelector(".dp-years")&&y(e,r,n)}),w("click","dp-next",r,function(){n.currentDate=c(n.currentDate,n.currentDate.getMonth()+1),t(s,n),n.onNavigate(n)}),w("click","dp-prev",r,function(){n.currentDate=c(n.currentDate,n.currentDate.getMonth()-1),t(s,n),n.onNavigate(n)}),w("click","dp-day",r,function(e){n.onChange(new Date(parseInt(e.target.getAttribute("data-date"))))}),w("click","dp-year",r,function(e){n.currentDate.setFullYear(parseInt(e.target.getAttribute("data-year"))),t(s,n),n.onSelectYear(n),n.onNavigate(n)}),w("click","dp-month",r,function(e){n.currentDate.setMonth(parseInt(e.target.getAttribute("data-month"))),t(s,n),n.onSelectMonth(n),n.onNavigate(n)}),w("click","dp-cal-year",r,function(){t(p,n)}),w("click","dp-cal-month",r,function(){t(l,n)}),w("click","dp-today",r,function(){n.onChange(o())}),w("click","dp-clear",r,function(){n.onChange(null)}),w("click","dp-close",r,n.close),n.onOpen(n)}}function h(e){var t=e.input||{},n=e.parse(t.value);e.currentDate=t.value&&e.inRange(n)?n:e.preselectedDate,e.selectedDate=new Date(e.currentDate),t.value&&(t.value=e.format(e.currentDate))}function D(e,t,n){var a=e.keyCode;a===N?M(t,n,-1):a===E?M(t,n,1):a===Y?M(t,n,-7):a===F&&M(t,n,7)}function y(e,t,n){var a=e.keyCode;a===N||a===Y?b(e,t,n,-1):a!==E&&a!==F||b(e,t,n,1)}function b(e,n,a,r){e.preventDefault();var o=a.currentDate.getFullYear()+r,i=Math.min(a.max.getFullYear(),Math.max(a.min.getFullYear(),o));a.currentDate.setFullYear(i),t(p,a),a.onNavigate(a)}function M(e,n,a){var r=n.currentDate;r.setDate(r.getDate()+a),t(s,n),n.onNavigate(n)}function w(e,t,n,a){function r(e){t.test(e.target.className)&&a(e)}return a?t=new RegExp("\\b"+t+"\\b"):(a=n,n=t,t=/.*/),n.addEventListener(e,r,!0),function(){n.removeEventListener(e,r,!0)}}function C(e){return e.isModal&&!!e.el}function x(e){e.focus(),/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream&&e.blur()}function S(e){var t=e.el;t&&t.parentElement.removeChild(t),e.el=void 0}function k(e){return"string"==typeof e?document.querySelector(e):e}var N=37,Y=38,E=39,F=40,T=function(){var e=window.CustomEvent;return"function"!=typeof e&&(e=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},e.prototype=window.Event.prototype),e}();return v});
//# sourceMappingURL=dist/tiny-date-picker.min.js.map